{
  "hash": "1881681229027cefc17ee69b8bada45d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework 6\"\nsubtitle: \"Time Series Regression\"\neval: false\n---\n\n\n\n# Getting started\n\n### Start with the following steps:\n\n-   Go to our RStudio Server at <http://turing.cornellcollege.edu:8787/>\n\n-   Open the respective file from the shared STA364_inst_files folder mentioned above. It will be named something like *hw-0X_LAST_NAME.qmd*.\n\n-   Then you need to save your copy. Click *File -\\> Save as -\\> Navigate to the folder `STA364_Projects` (that we share) -\\> Change the \"LAST_NAME part of the file name to your last name -\\> Save*.\n\n-   Update the top of the document, called the `YAML,` with your name.\n\n# Homework Instructions\n\n:::{.callout-note}\nBe sure to include the relevant R code and complete sentences answering each question (e.g., if I ask for the average, you can output the answer in R but **also** write a complete sentence with the answer). Be sure to save your files frequently!\n\nFrom this point forward, you need to start commenting on your graphs. What do you observe? Are there trends/cycles/seasonal effects? Outliers? Other interesting features?\n:::\n\n:::{.callout-important}\nYou will now need to make your own R chunks for problems that require code. You should name each chunk appropriately, for example, `q1_a`. This process assures that when you render and get an error, the error tells you which chunk is causing the error. You **cannot** use duplicate chunk labels.\n\n\\`\\`\\`{r q1_a}\n\n\\`\\`\\`\n\n:::\n\nData for the homework is in the *STA364_inst_files \\> data* folder.\n\n# Exercises\n\n## Problems\n\n### Question 1 (fpp7_1)\n\nHalf-hourly electricity demand for Victoria, Australia is contained in *vic_elec*. Extract the January 2014 electricity demand, and aggregate this data to daily with daily total demands and maximum temperatures.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\njan14_vic_elec <- vic_elec |>\n  filter(yearmonth(Time) == yearmonth(\"2014 Jan\")) |>\n  index_by(Date = as_date(Time)) |>\n  summarise(\n    Demand = sum(Demand),\n    Temperature = max(Temperature)\n  )\n```\n:::\n\n\n\na. Plot the data and find the regression model for Demand with temperature as a predictor variable. Why is there a positive relationship?\n\nb. Produce a residual plot. Is the model adequate? Are there any outliers or influential observations?\n\nc. Use the model to forecast the electricity demand that you would expect for the next day if the maximum temperature was $15C^\\circ$ and compare it with the forecast if the with maximum temperature was $35C^\\circ$. Do you believe these forecasts? The following R code will get you started:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\njan14_vic_elec |>\n  model(TSLM(Demand ~ Temperature)) |>\n  forecast(\n    new_data(jan14_vic_elec, 1) |>\n      mutate(Temperature = 15)\n  ) |>\n  autoplot(jan14_vic_elec)\n```\n:::\n\n\n\nd. Give prediction intervals for your forecasts.\n\ne. Plot Demand vs Temperature for all of the available data in *vic_elec* aggregated to daily total demand and maximum temperature. What does this say about your model?\n\n\n### Question 2 (fpp7_4)\n\nThe data set *souvenirs* concerns the monthly sales figures of a shop which opened in January 1987 and sells gifts, souvenirs, and novelties. The shop is situated on the wharf at a beach resort town in Queensland, Australia. The sales volume varies with the seasonal population of tourists. There is a large influx of visitors to the town at Christmas and for the local surfing festival, held every March since 1988. Over time, the shop has expanded its premises, range of products, and staff.\n\n\na. Produce a time plot of the data and describe the patterns in the graph. Identify any unusual or unexpected fluctuations in the time series.\n\nb. Explain why it is necessary to take logarithms of these data before fitting a model.\n\nc. Fit a regression model to the logarithms of these sales data with a linear trend, seasonal dummies and a “surfing festival” dummy variable.\n\nTo create a new variable, you use the `mutate` function. The following code creates a variable that is TRUE (1) if it is the surfing festival and FALSE (0) otherwise. Fill the \n\n`mutate(festival = month(Month) == CHANGE & year(Month) != CHANGE) |>`\n\n\nd. Plot the residuals against time and against the fitted values. Do these plots reveal any problems with the model?\n\n:::{.callout-tip}\nSending your fitted model object into the `components()` function give a nice dataframe with the .resid column and .fitted columns.\n:::\n\ne. Do boxplots of the residuals for each month. Does this reveal any problems with the model?\n\n:::{.callout-tip}\n\nTo create a boxplot, use the function `data |> ggplot(aes(x=variable)) + geom_boxplot()`. Swap out the data and variable. \n\n:::\n\nf. What do the values of the coefficients tell you about each variable? Interpret coefficients for the intercept, the trend, one of the seasons and the festival variables. \n\ng. What does the Ljung-Box test tell you about your model?\n\nh. Regardless of your answers to the above questions, use your regression model to predict the monthly sales for 1994, 1995, and 1996. Produce prediction intervals for each of your forecasts.\n\n\n### Question 3 (fpp7_5)\n\n\nThe *us_gasoline* series consists of weekly data for supplies of US finished motor gasoline product, from 2 February 1991 to 20 January 2017. The units are in “million barrels per day”. Consider only the data to the end of 2004.\n\na. Fit a harmonic regression with trend to the data. Experiment with changing the number Fourier terms. Plot the observed gasoline and fitted values and comment on what you see.\n\nb. Select the appropriate number of Fourier terms to include by minimizing the AICc value, the BIC, and maximizing adjusted $R^2$.\n\n:::{.callout-tip}\n\ni. The table of metrics can be found by using the `glance` function on your model object. \n\nii. There is a vary large number of metrics in the table. You may need to use a `select()` to pick the metrics you want to see. Their names are `adj_r_squared`, `AICc` and `BIC`. \n:::\n\nc. Plot the residuals of the final model using the `gg_tsresiduals()` function and comment on these. Use a Ljung-Box test to check for residual autocorrelation.\n\n\n### Question 4 (fpp7_6)\n\n\nThe annual population of Afghanistan is available in the *global_economy* data set.\n\na. Plot the data and comment on its features. Can you observe the effect of the Soviet-Afghan war?\n\nb. Fit a linear trend model and compare this to a piecewise linear trend model with knots at 1980 and 1989.\n\nc. Generate forecasts from these two models for the five years after the end of the data, and comment on the results.\n\n\n\n\n\n# Submission\n\nWhen you are finished with your homework, be sure to Render the final document. Once rendered, you can download your file by:\n\n-   Finding the .html file in your File pane of RStudio (on the bottom right of the screen)\n-   Click the check box next to the file\n-   Click the blue gear above and then click \"Export\" to download\n-   Submit your final HTML document to the respective assignment on [Moodle]({{< var course.moodle >}})\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}